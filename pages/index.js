import Head from "next/head";
import styles from "../styles/Home.module.css";
import React, { useState, useEffect } from "react";
import Image from "next/image";

export default function Home() {
  const [information, setInformation] = useState(false);
  const [value, setValue] = useState(87683422);
  const [valueCount, setValueCount] = useState(false);
  const number = 45000;

  async function start() {
    let count = 0;
    const interval = setInterval(() => {
      count += 1000 / 60;
      setValueCount(count);
      if (count > number) {
        clearInterval(interval);
      }
    }, 1000 / 60);

    let search = await fetch(`http://192.168.3.10:3000/api?account_id=${value}`)
      .then((response) => {
        return response.json();
      })
      .then((data) => {
        return data;
      })
      .catch(() => {
        return {};
      });
    await setInformation(search);
    console.log(information);
  }

  useEffect(() => {
    console.log(information);
  }, []);

  return (
    <div className="main">
      <Head>
        <title>Create Next App</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <div className="insert">
        <input
          className="myButton"
          type="number"
          placeholder="account id"
          onChange={(e) => {
            console.log(e.target.value);
            setValue(e.target.value);
          }}
        />
        <button className="myButton" onClick={start}>
          buscar
        </button>
      </div>
      {!information && valueCount && (
        <div>
          
          <input style={{width:"350px"}} type="range" value={valueCount} max={number} />
          <h1 style={{textAlign:"center"}}>Aguarde...</h1>
        </div>
      )}
      {information && (
        <table className="customTable">
          <thead>
            <tr>
              <th>
                <h1>{information.personaname}</h1>
              </th>
              <th>
                <img
                  src={information.avatarfull}
                  alt={information.personaname}
                  width={200}
                  height={200}
                />
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>assists</td>
              <td>{information.status_players.assists}</td>
            </tr>
            <tr>
              <td>deaths</td>
              <td>{information.status_players.deaths}</td>
            </tr>
            <tr>
              <td>denies</td>
              <td>{information.status_players.denies}</td>
            </tr>
            <tr>
              <td>gold_per_min</td>
              <td>{information.status_players.gold_per_min}</td>
            </tr>
            <tr>
              <td>hero_damage</td>
              <td>{information.status_players.hero_damage}</td>
            </tr>
            <tr>
              <td>hero_healing</td>
              <td>{information.status_players.hero_healing}</td>
            </tr>
            <tr>
              <td>kills</td>
              <td>{information.status_players.kills}</td>
            </tr>
            <tr>
              <td>last_hits</td>
              <td>{information.status_players.last_hits}</td>
            </tr>
            <tr>
              <td>net_worth</td>
              <td>{information.status_players.net_worth}</td>
            </tr>
            <tr>
              <td>tower_damage</td>
              <td>{information.status_players.tower_damage}</td>
            </tr>
            <tr>
              <td>win_rate</td>
              <td>{information.status_players.win}%</td>
            </tr>
            <tr>
              <td>xp_per_min</td>
              <td>{information.status_players.xp_per_min}</td>
            </tr>
          </tbody>
        </table>
      )}
    </div>
  );
}
